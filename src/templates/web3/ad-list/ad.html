{% extends 'web3/base.html'%}
{% load static %}
{% load i18n %}
{% block content %} 

<div class="wrapper">
    <section class="section__control">
        <div class="general__container">
            <div class="control">
                <a href="#" class="control__logo">
                    <svg width="112" height="31" viewBox="0 0 112 31" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g clip-path="url(#clip0_216_1629)">
                            <path d="M48.5264 11.5892H46.5585L46.1817 12.6232C45.1559 11.6512 43.9626 11.1756 42.5809 11.1756C41.1155 11.1756 39.8594 11.7339 38.7918 12.83C37.745 13.926 37.2217 15.2289 37.2217 16.7592C37.2217 18.3103 37.745 19.6131 38.7918 20.7092C39.8594 21.8052 41.1155 22.3429 42.5809 22.3429C43.9626 22.3429 45.1559 21.8673 46.1817 20.8953L46.5585 21.9293H49.8662V19.9854L48.5264 19.489V11.5892ZM42.874 19.9026C42.0157 19.9026 41.2621 19.5924 40.634 18.9927C40.006 18.3723 39.692 17.6278 39.692 16.7592C39.692 15.8907 40.006 15.1462 40.634 14.5464C41.2621 13.926 42.0157 13.6158 42.874 13.6158C43.7533 13.6158 44.5069 13.926 45.114 14.5464C45.7421 15.1462 46.0561 15.8907 46.0561 16.7592C46.0561 17.6278 45.7421 18.3723 45.114 18.9927C44.5069 19.5924 43.7533 19.9026 42.874 19.9026ZM58.9643 11.5892L56.2428 19.8819L53.5213 11.5892H50.3812V13.5331L51.721 14.0294L54.3169 21.9293H58.1688L60.7647 14.0294L62.1045 13.5331V11.5892H58.9643ZM68.0048 19.9026C67.1674 19.9026 66.4975 19.2409 66.4975 18.4137V13.6572H67.7117V11.5892H66.4975V8.79734H64.0273V11.5892H62.6874V13.6572H64.0273V18.4137C64.0273 19.9233 64.8856 21.2675 66.2045 21.9293H68.0048V19.9026ZM74.6833 11.1756C73.1132 11.1756 71.7943 11.7339 70.6848 12.83C69.5752 13.926 69.0309 15.2289 69.0309 16.7592C69.0309 18.3103 69.5752 19.6131 70.6848 20.7092C71.7943 21.8052 73.1132 22.3429 74.6833 22.3429C76.2324 22.3429 77.5513 21.8052 78.6608 20.7092C79.7704 19.6131 80.3356 18.3103 80.3356 16.7592C80.3356 15.2289 79.7704 13.926 78.6608 12.83C77.5513 11.7339 76.2324 11.1756 74.6833 11.1756ZM74.6833 19.9026C73.804 19.9026 73.0504 19.5924 72.4223 18.9927C71.8152 18.3723 71.5012 17.6278 71.5012 16.7592C71.5012 15.9113 71.8152 15.1669 72.4223 14.5464C73.0504 13.926 73.804 13.6158 74.6833 13.6158C75.5416 13.6158 76.2952 13.926 76.9233 14.5464C77.5513 15.1669 77.8653 15.9113 77.8653 16.7592C77.8653 17.6278 77.5513 18.3723 76.9233 18.9927C76.2952 19.5924 75.5416 19.9026 74.6833 19.9026ZM88.5387 11.1756C87.157 11.1756 85.9638 11.6512 84.9589 12.6025L84.5821 11.5892H81.2535V13.5331L82.5933 14.0294V26.0653H85.0636V21.0194C86.0684 21.9086 87.2198 22.3429 88.5387 22.3429C90.0251 22.3429 91.2811 21.8052 92.3279 20.7298C93.3746 19.6545 93.898 18.3516 93.898 16.842V16.6765C93.898 15.1669 93.3746 13.864 92.3279 12.7886C91.2811 11.7133 90.0251 11.1756 88.5387 11.1756ZM88.2456 19.9026C87.3873 19.9026 86.6337 19.5924 86.0056 18.9927C85.3776 18.3723 85.0636 17.6278 85.0636 16.7592C85.0636 15.8907 85.3776 15.1462 86.0056 14.5464C86.6337 13.926 87.3873 13.6158 88.2456 13.6158C89.1249 13.6158 89.8785 13.926 90.4856 14.5464C91.1137 15.1462 91.4277 15.8907 91.4277 16.7592C91.4277 17.6278 91.1137 18.3723 90.4856 18.9927C89.8785 19.5924 89.1249 19.9026 88.2456 19.9026ZM98.7011 11.5892H94.891V13.5331L96.2308 14.0294V21.9293H100.041V19.9854L98.7011 19.489V11.5892ZM96.3773 7.80469V9.97611H98.5755V7.80469H96.3773ZM104.626 21.9293V19.1788L105.946 17.7105L109.232 21.9293H111.786V19.9854L110.447 19.489L107.62 15.8493L111.472 11.5892H108.165L104.626 15.5184V7.45312H100.816V9.41775L102.156 9.89339V21.9293H104.626Z" fill="black"/>
                            <path d="M24.0748 0.973633H6.28037C2.81182 0.973633 0 3.75129 0 7.17771V24.7559C0 28.1823 2.81182 30.96 6.28037 30.96H24.0748C27.5433 30.96 30.3551 28.1823 30.3551 24.7559V7.17771C30.3551 3.75129 27.5433 0.973633 24.0748 0.973633Z" fill="#FF1700"/>
                            <path d="M22.6094 8.2122H19.6576L19.0923 9.76322C17.5537 8.30527 15.7637 7.5918 13.6912 7.5918C11.4931 7.5918 9.60898 8.42935 8.00748 10.0734C6.43739 11.7175 5.65234 13.6718 5.65234 15.9673C5.65234 18.2938 6.43739 20.2481 8.00748 21.8922C9.60898 23.5363 11.4931 24.3428 13.6912 24.3428C15.7637 24.3428 17.5537 23.6293 19.0923 22.1714L19.6576 23.7224H24.6191V20.8065L22.6094 20.062V8.2122ZM14.1308 20.6824C12.8434 20.6824 11.7129 20.2171 10.7708 19.3175C9.82879 18.3869 9.35776 17.2702 9.35776 15.9673C9.35776 14.6644 9.82879 13.5477 10.7708 12.6481C11.7129 11.7175 12.8434 11.2522 14.1308 11.2522C15.4497 11.2522 16.5802 11.7175 17.4908 12.6481C18.4329 13.5477 18.9039 14.6644 18.9039 15.9673C18.9039 17.2702 18.4329 18.3869 17.4908 19.3175C16.5802 20.2171 15.4497 20.6824 14.1308 20.6824Z" fill="white"/>
                        </g>
                        <defs>
                            <clipPath id="clip0_216_1629">
                                <rect width="112" height="29.9864" fill="white" transform="translate(0 0.973633)"/>
                            </clipPath>
                        </defs>
                    </svg>
                </a>
                <!-- /.control__back -->
                <button type="button" class="control__close">
                    <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10 10L20 20" stroke="#FF1700" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M20 10L10 20" stroke="#FF1700" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
            </div>
            <!-- /.progress -->
        </div>
        <!-- /.general__container -->
    </section>
    <!-- /.section__progress -->

    <section class="section__types">
        <div class="general__container">
            <div class="types">
                {% for category in categories %}
                <a href="{% url 'web3:category-view' category_id=category.id user_id=request.user.id %}" class="types__type">
                    <span class="types__pic">
                        <span class="general__circle">
                            <span class="types__ico">
                                {% if category.image %}
                                    <img src="{{ category.image.url }}"  style="max-width: 90%; margin: 0 auto;" alt="">
                                {% endif %}
                            </span>
                            <!-- /.types__ico -->
                        </span>
                        <!-- /.general__circle -->
                    </span>
                    <!-- /.types__pic -->
                    <span class="types__name general-M">{% if LANGUAGE_CODE == 'uz' %}{{category.title.title_uz}}{% else %}{{category.title.title_ru}}{% endif %}</span>
                    <!-- /.types__name -->
                </a>
                {% endfor %}
            </div>
            <!-- /.types -->
        </div>
        <!-- /.general__container -->
    </section>
    <!-- /.section__types -->
    <section class="section__add">
        <div class="general__container">
            <h2 class="general__title">{% translate 'hot_offers' %}</h2>
            <!-- /.general__title -->
            <!-- /.favorite__active -->
            <div class="add">
                {% for ad in ads.items %}
                <div class="add__item">
                    <div class="add__pic">
                        <!-- /.favorite__rate -->
                        <img src="{{ ad.images.0 }}" class="add__car" alt="">
                        {% if ad.favourite == True %}
                            <a href="#" onclick="LikedFun('{{ad.id}}', this)" class="add__liked liked">
                                <svg width="20" height="21" viewBox="0 0 20 21" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M15.1254 10.8972L15.1326 10.9048L10 15.932L4.86736 10.9048L4.87462 10.8972C4.27858 10.2166 3.96715 9.34049 4.00275 8.4445C4.03835 7.54851 4.41833 6.69879 5.06656 6.06561C5.71479 5.43244 6.58338 5.06258 7.49827 5.03016C8.41316 4.99774 9.30676 5.30515 10 5.89079C10.6933 5.30515 11.5869 4.99774 12.5018 5.03016C13.4166 5.06258 14.2852 5.43244 14.9334 6.06561C15.5817 6.69879 15.9616 7.54851 15.9972 8.4445C16.0329 9.34049 15.7214 10.2166 15.1254 10.8972Z" fill="white"/>
                                </svg>
                            </a>
                        {% else %}
                            <a href="#" onclick="LikedFun('{{ad.id}}', this)" class="add__liked">
                                <svg width="13" height="12" viewBox="0 0 13 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M11.4636 6.33582L11.3853 6.42522L6.71437 11.0001L2.04343 6.42523L1.96512 6.33581C1.45259 5.75058 1.18625 4.99921 1.21671 4.23241C1.24718 3.46559 1.57239 2.73631 2.13028 2.19137C2.68849 1.64613 3.43841 1.32597 4.23033 1.29791C5.02228 1.26985 5.79426 1.53611 6.39171 2.04081L6.71437 2.31338L7.03703 2.04081C7.63448 1.53611 8.40646 1.26985 9.19842 1.29791C9.99032 1.32597 10.7403 1.64614 11.2984 2.19135L11.2984 2.19138C11.8563 2.7363 12.1815 3.46557 12.212 4.23243C12.2425 4.9992 11.9761 5.75058 11.4636 6.33582Z" stroke="white"/>
                                </svg>
                                    
                            </a>
                            <!-- /.liked -->
                        {% endif %}
                        <div class="add__images">
                            <svg width="9" height="10" viewBox="0 0 9 10" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M4.5 6.75879C4.96875 6.75879 5.36725 6.59479 5.6955 6.26679C6.0235 5.93854 6.1875 5.54004 6.1875 5.07129C6.1875 4.60254 6.0235 4.20404 5.6955 3.87579C5.36725 3.54779 4.96875 3.38379 4.5 3.38379C4.03125 3.38379 3.63275 3.54779 3.3045 3.87579C2.9765 4.20404 2.8125 4.60254 2.8125 5.07129C2.8125 5.54004 2.9765 5.93854 3.3045 6.26679C3.63275 6.59479 4.03125 6.75879 4.5 6.75879ZM1.5 8.07129C1.29375 8.07129 1.11725 7.99791 0.9705 7.85116C0.8235 7.70416 0.75 7.52754 0.75 7.32129V2.82129C0.75 2.61504 0.8235 2.43854 0.9705 2.29179C1.11725 2.14479 1.29375 2.07129 1.5 2.07129H2.68125L3.375 1.32129H5.625L6.31875 2.07129H7.5C7.70625 2.07129 7.88287 2.14479 8.02987 2.29179C8.17663 2.43854 8.25 2.61504 8.25 2.82129V7.32129C8.25 7.52754 8.17663 7.70416 8.02987 7.85116C7.88287 7.99791 7.70625 8.07129 7.5 8.07129H1.5Z" fill="white"/>
                            </svg>
                            <span class="general-R">{{ad.images|length }}</span>
                        </div>
                        <!-- /.favorite__images -->
                    </div>
                    <!-- /.favorite__pic -->
                    <div class="add__content">
                        <a href="{% url 'web3:ad-view' ad_id=ad.id %}" class="add__name">{{ad.title}}</a>
                        <!-- /.favorite__name -->
                        <p class="add__price general-DB">{{ad.prices.narx}}
                        {% if ad.currency == 1%}so'm
                        {% elif ad.currency == 2%} y.e
                        {% endif %} 
                        </p>
                        <!-- /.favorite__price -->
                        <div class="add__row">
                            <p class="add__date general-R">{{ad.created_at.uz}}</p>
                            <!-- /.favorite__date -->
                            <div class="add__views">
                                <svg width="15" height="16" viewBox="0 0 15 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M8.82605 7.1077C9.55793 7.83924 9.55793 9.02683 8.82605 9.75962C8.09418 10.4912 6.90605 10.4912 6.17293 9.75962C5.44105 9.02808 5.44105 7.84049 6.17293 7.1077C6.90605 6.37491 8.09355 6.37491 8.82605 7.1077" stroke="#A0A0A0" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M1.875 8.43209C1.875 8.0204 1.97 7.61309 2.15375 7.23764V7.23764C3.10062 5.30289 5.19313 4.05908 7.5 4.05908C9.80687 4.05908 11.8994 5.30289 12.8463 7.23764V7.23764C13.03 7.61309 13.125 8.0204 13.125 8.43209C13.125 8.84378 13.03 9.25109 12.8463 9.62655V9.62655C11.8994 11.5613 9.80687 12.8051 7.5 12.8051C5.19313 12.8051 3.10062 11.5613 2.15375 9.62655V9.62655C1.97 9.25109 1.875 8.84378 1.875 8.43209Z" stroke="#A0A0A0" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                <p class="add__view">{{ad.views_count}}</p>
                                <!-- /.favorite__view -->
                            </div>
                            <!-- /.favorite__views -->
                        </div>
                        <!-- /.favorite__row -->
                    </div>
                    <!-- /.favorite__content -->
                </div>
                {% endfor %}
            </div>
            <!-- /.favorite -->
        </div>
        <!-- /.general__container -->
    </section>

</div>
<!-- /.wrapper -->

{% endblock content %}
{% block javascript %}
<script>
    function LikedFun(id, this_data) {
        if(this_data.classList.contains('liked')){
            this_data.classList.remove('liked');
            var svg = `<svg width="13" height="12" viewBox="0 0 13 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M11.4636 6.33582L11.3853 6.42522L6.71437 11.0001L2.04343 6.42523L1.96512 6.33581C1.45259 5.75058 1.18625 4.99921 1.21671 4.23241C1.24718 3.46559 1.57239 2.73631 2.13028 2.19137C2.68849 1.64613 3.43841 1.32597 4.23033 1.29791C5.02228 1.26985 5.79426 1.53611 6.39171 2.04081L6.71437 2.31338L7.03703 2.04081C7.63448 1.53611 8.40646 1.26985 9.19842 1.29791C9.99032 1.32597 10.7403 1.64614 11.2984 2.19135L11.2984 2.19138C11.8563 2.7363 12.1815 3.46557 12.212 4.23243C12.2425 4.9992 11.9761 5.75058 11.4636 6.33582Z" stroke="white"/>
                    </svg>`
            $(this_data).html(svg)
        }else{
            this_data.classList.add('liked');
            var svg = `<svg width="20" height="21" viewBox="0 0 20 21" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M15.1254 10.8972L15.1326 10.9048L10 15.932L4.86736 10.9048L4.87462 10.8972C4.27858 10.2166 3.96715 9.34049 4.00275 8.4445C4.03835 7.54851 4.41833 6.69879 5.06656 6.06561C5.71479 5.43244 6.58338 5.06258 7.49827 5.03016C8.41316 4.99774 9.30676 5.30515 10 5.89079C10.6933 5.30515 11.5869 4.99774 12.5018 5.03016C13.4166 5.06258 14.2852 5.43244 14.9334 6.06561C15.5817 6.69879 15.9616 7.54851 15.9972 8.4445C16.0329 9.34049 15.7214 10.2166 15.1254 10.8972Z" fill="white"/>
                    </svg>`
            $(this_data).html(svg)
        };
        $.ajax({
            url: window.location.origin + "/api/v1/items/favourites/?ad=" + id + "&user=" + '{{request.user.id}}',
            method: 'POST',
            success: function(data){
            }
        });
        
    }
</script>
{% endblock javascript %}